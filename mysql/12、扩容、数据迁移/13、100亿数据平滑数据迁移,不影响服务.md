## [原文](https://cloud.tencent.com/developer/article/1048685)

## [数据平滑迁移方案](https://blog.ppjys.cn/2019/06/12/%E6%95%B0%E6%8D%AE%E5%B9%B3%E6%BB%91%E8%BF%81%E7%A7%BB%E6%96%B9%E6%A1%88/)

## [记一次数据双写平滑迁移实践](https://quericy.me/blog/867/)

# 100亿数据平滑数据迁移,不影响服务


## 一、问题的提出

- 底层表结构变更
- 分库个数变换
- 底层存储介质变换

## 二 、实现方案
- 停机方案
- 平滑迁移-追日志法
- 平滑迁移-双写法

## 三、实现详情

### 停机方案

### 平滑迁移-追日志法

### 平滑迁移-双写法

##四、遇到的问题

## 五、总结

针对互联网很多“数据量较大，并发量较大，业务复杂度较高”的业务场景，在

（1）底层表结构变更

（2）分库个数变换

（3）底层存储介质变换

的众多需求下，需要进行数据迁移，完成“平滑迁移数据，迁移过程不停机，保证系统持续服务”有两种常见的解决方案。

追日志法，五个步骤：

（1）服务进行升级，记录“对旧库上的数据修改”的日志

（2）研发一个数据迁移小工具，进行数据迁移

（3）研发一个读取日志小工具，追平数据差异

（4）研发一个数据比对小工具，校验数据一致性

（5）流量切到新库，完成平滑迁移

双写法，四个步骤：

（1）服务进行升级，记录“对旧库上的数据修改”进行新库的双写

（2）研发一个数据迁移小工具，进行数据迁移

（3）研发一个数据比对小工具，校验数据一致性

（4）流量切到新库，完成平滑迁移




