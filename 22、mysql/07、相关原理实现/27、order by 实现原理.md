
<https://zhuanlan.zhihu.com/p/389583415>

#  order by 实现原理

需要进行排序的数据全部会放到`sort buffer`里进行排序，sort buffer是在`内存`中的一块空间，
我们可以通过sort_buffer_size 参数来设置sort buffer的大小。但我们设置的空间始终是有限的，
如果需要`排序的数据量大于sort buffer的空间`这时怎么办。

如果当sort buffer空间无法容纳我们需要排序的数据时，
这时会采用另外一种`临时文件`的方式进行排序，临时文件排序采用`归并排序`的算法，
首先会把需要排序的数据`拆分`到`多个临时文件`里同步进行排序操作，
然后把多个排好序的文件`合并`成一个结果集返回给客户端，
不过在临时文件里排序相对于在sort buffer里排序来说，性能会慢很多，
因为毕竟一个是在内存里操作，而一个是需要在磁盘文件里操作

> mysql为了尽量避免使用临时文件排序，所以会进行一下优化，
> 它会避免非必要的字段放到sort buffer中进行排序
