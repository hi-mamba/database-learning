
### [原文1](https://www.cnblogs.com/duanxz/p/3799045.html)

### [原文2](https://blog.csdn.net/u010425776/article/details/60968248)


# 索引简介、分类

## 索引的本质
> MySQL官方对索引的定义为：索引（Index）是帮助MySQL高效获取数据的数据结构。

在数据之外，数据库系统还维护着满足特定查找算法的数据结构，
这些数据结构以某种方式引用（指向）数据，
这样就可以在这些数据结构上实现高级查找算法。这种数据结构，就是索引

## 没有索引时mysql是如何查询到数据的

索引对查询的速度有着至关重要的影响，理解索引也是进行数据库性能调优的起点。
考虑如下情况，假设数据库中一个表有10^6条记录，DBMS的页面大小为4K，
并存储100条记录。`如果没有索引，查询将对整个表进行扫描`，最坏的情况下。

如果所有数据页都不在内存，需要读取10^4个页面，如果这10^4个页面在磁盘上随机分布，`需要进行10^4次I/O`，
假设磁盘每次I/O时间为10ms(忽略数据传输时间)，则`总共需要100s`(但实际上要好很多很多)。
如果对之建立B-Tree索引，则只需要进行`log100(10^6)=3次页面读取`，`最坏情况下耗时30ms`。这就是索引带来的效果，很多时候，
当你的应用程序进行SQL查询速度很慢时，应该想想是否可以建索引。

## 什么是索引？

索引（在MYSQL中也叫做键<key>），是`存储引擎用于快速找到记录`的一种数据结构。
索引用来快速地寻找那些具有特定值的记录，所有MySQL索引都以`B-树`的形式保存。
如果没有索引，执行查询时MySQL必须从`第一个记录开始扫描整个表的所有记录`，直至找到符合要求的记录。
表里面的记录数量越多，这个操作的代价就越高。
如果作为搜索条件的列上已经创建了索引，MySQL无需扫描任何记录即可迅速得到目标记录所在的位置。
如果表有1000个记录，通过索引查找记录至少要比顺序扫描记录快100倍。 

索引优化应该是对查询性能优化最有效的手段了，索引能够轻易将查询性能提高几个数量级，
”最优“的索引有时比一个”好的“索引性能要好两个数量级。创建一个真正”最优“的索引经常要重写查询。

## 分类

### 从`数据结构`角度

- 1、B+树索引(O(log(n)))：关于B+树索引，
可以参考 [MySQL索引背后的数据结构及算法原理](http://blog.codinglabs.org/articles/theory-of-mysql-index.html)

- 2、hash索引：
  
  - a 仅仅能满足"=","IN"和"<=>"查询，不能使用范围查询
  
  - b 其检索效率非常高，索引的检索可以一次定位，
  不像B-Tree 索引需要从根节点到枝节点，最后才能访问到页节点这样多次的IO访问，
  所以 Hash 索引的查询效率要远高于 B-Tree 索引
  
  - c 只有Memory存储引擎显示支持hash索引

- 3、FULLTEXT索引（现在MyISAM和InnoDB引擎都支持了）

- 4、R-Tree索引（用于对GIS数据类型创建SPATIAL索引）

### 从物理存储角度

- 1、聚集索引（clustered index）

- 2、非聚集索引（non-clustered index）

### 从逻辑角度

- 1、主键索引：主键索引是一种特殊的唯一索引，不允许有空值

- 2、普通索引或者单列索引

- 3、多列索引（复合索引）：复合索引指多个字段上创建的索引，只有在查询条件中使用了创建索引时的第一个字段，索引才会被使用。使用复合索引时遵循最左前缀集合

- 4、唯一索引或者非唯一索引

- 5、空间索引：空间索引是对空间数据类型的字段建立的索引，MYSQL中的空间数据类型有4种，分别是GEOMETRY、POINT、LINESTRING、POLYGON。MYSQL使用SPATIAL关键字进行扩展，使得能够用于创建正规索引类型的语法创建空间索引。创建空间索引的列，必须将其声明为NOT NULL，空间索引只能在存储引擎为MYISAM的表中创建

 
#### 索引的类型的详解

- [索引的类型详解-按照逻辑角度分](04、索引的类型详解-按照逻辑角度分.md) 

- [索引的类型详解-按照逻辑角度分](05、索引的类型详解-从数据结构角度.md) 

- [索引的类型详解-按照逻辑角度分](06、索引的类型详解-从物理存储角度索引分类.md)

## 总结

1. 索引的作用：提高数据查询效率

2. 常见索引模型：哈希表、有序数组、搜索树

3. 哈希表：键 - 值(key - value)。

4. 哈希思路：把值放在数组里，用一个哈希函数把key换算成一个确定的位置，然后把value放在数组的这个位置

5. 哈希冲突的处理办法：链表

6. 哈希表适用场景：只有等值查询的场景

7. 有序数组：按顺序存储。查询用二分法就可以快速查询，时间复杂度是：O(log(N))

8. 有序数组查询效率高，更新效率低

9. 有序数组的适用场景：静态存储引擎。

10. 二叉搜索树：每个节点的左儿子小于父节点，父节点又小于右儿子

11. 二叉搜索树：查询时间复杂度O(log(N))，更新时间复杂度O(log(N))

12. 数据库存储大多不适用二叉树，因为树高过高，会适用N叉树

13. InnoDB中的索引模型：B+Tree

14. 索引类型：主键索引、非主键索引
主键索引的叶子节点存的是整行的数据(聚簇索引)，非主键索引的叶子节点内容是主键的值(二级索引)

15. 主键索引和普通索引的区别：主键索引只要搜索ID这个B+Tree即可拿到数据。普通索引先搜索索引拿到主键值，再到主键索引树搜索一次(回表)

16. 一个数据页满了，按照B+Tree算法，新增加一个数据页，叫做页分裂，会导致性能下降。
空间利用率降低大概50%。当相邻的两个数据页利用率很低的时候会做数据页合并，合并的过程是分裂过程的逆过程。

17. 从性能和存储空间方面考量，自增主键往往是更合理的选择。

