<https://developer.aliyun.com/article/312547?spm=a2c6h.13813017.content3.12.44631c4809RxKC>

[分库分表最佳实践](https://www.cnblogs.com/whgk/p/15251270.html)


# 分表数据不均匀和热点问题

参考阿里开发手册建议：

1.单表行数超过 500 万行或者单表容量超过 2GB，才推荐进行分库分表；如果预计三年后的数据量根本达不到这个级别，请不要在创建表时就分库分表。

2.实际情况受mysql机器配置等多方面影响，可能数据量很大但性能依旧不错，但考虑后续发展一定要进行分库分表考虑。

## 水平分库

订单水平分库分表，为什么要按照用户id`取模`切分呢？

- 好处：查询指定用户的所有订单，避免了跨库跨表查询

- 缺点：数据分散不均匀，某些表的数据量特别大，某些表的数据量很小。
因为某些用户下单量多，打个比方，1000-2000这个范围内的用户，下单特别多，
 而他们的id根据计算规则，都是分到了x库x表。造成这个表的数据量大，单表的数据量撑到极限后，咋办呢?

> 分片字段随机，但不均匀，如对总分片取模后，会导致数据不均匀，建议先对分片字段进行2次随机处理（如：zebra提供的：md5/crc32 方法）

![image](https://user-images.githubusercontent.com/7867225/146791030-d3d291a8-d6f4-459e-9b02-c018e8e80f1d.png)


## 总结一下：
每种分库分表方案也不是十全十美，都是有利有弊的。目前来说，这种使用用户id来切分订单数据的方案，还是被大部分公司给使用。
实际效果还不错。程序员省事，至于数据量暴涨，以后再说呢。
毕竟公司业务发展到什么程度，不知道的，项目存活期多久，未来不确定。先扛住再说。
