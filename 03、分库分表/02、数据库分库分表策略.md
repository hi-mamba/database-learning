
## [原文](https://tech.meituan.com/2016/11/18/dianping-order-db-sharding.html)

# 数据库分库分表策略

## 切分策略

### 1. 查询切分
将ID和库的Mapping关系记录在一个单独的库中。
```
优点：ID和库的Mapping算法可以随意更改。
缺点：引入额外的单点。
```

### 2. 范围切分
比如按照时间区间或ID区间来切分。
```
优点：单表大小可控，天然水平扩展。
缺点：无法解决集中写入瓶颈的问题
```

### 3. Hash切分
一般采用Mod来切分，下面着重讲一下Mod的策略。


数据水平切分后我们希望是一劳永逸或者是易于水平扩展的，所以推荐采用mod 2^n这种一致性Hash。

以统一订单库为例，我们分库分表的方案是32*32的，即通过UserId后四位mod 32分到32个库中，
同时再将UserId后四位Div 32 Mod 32将每个库分为32个表，共计分为1024张表。
线上部署情况为8个集群(主从)，每个集群4个库。
