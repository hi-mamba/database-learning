
## [原文](https://www.zhihu.com/question/56236190)

# 阿里巴巴JAVA开发手册》里面写超过三张表禁止join 这是为什么？这样的话那sql要怎么写？


1. 让这些做优化器每天想着解决十多个表Join的人不好优化



2. 从数据库实现角度来说确实也不建议太多表连接，从优化器的角度而言，选择连接路径的算法目前比较主流的是动态规划和贪心算法，
在连接表数比较少的时候选择动态规划，一阶段一阶段的去分析各种可能得连接顺序得到一个最优的执行计划，但动态规划场景下，
随表的增加，计划也会爆炸式增加，优化器在选择最优计划的前提下，消耗的内存和CPU是不能不考虑的，
所以当表的数量太多，数据库会退化成贪心算法，尽快，尽量少的消耗计算资源前提下出一个计划，这个计划可能不是执行最优的计划

 
 3. 如果数据库的性能无限强大，多个表的join肯定是需要的，尤其是复杂的分析型(OLAP)查询，甚至可能涉及10几个表的join，
 但现实是大部分数据库的性能都太弱了，尤其是涉及到多表join的查询。
 
 
 ## 在这种限制下SQL怎么写？
 
 是我确实需要两个表里的数据链接在一起啊，我们可以做个冗余，建表的时候，就把这些列放在一个表里，
 比如一开始有student(id, name)，class(id, description)，student_class(student_id, class_id)三张表，
 这样是符合数据库范式的(第一范式，第二范式，第三范式，BC范式等)，没有任何冗余，但是马上就不符合“编程规范“了，
 那我们可以用一张大表代替它，student_class_full(student_id, class_id, name, description)，这样name和description可能要被存储多份，
 但是由于不需要join了，查询的性能就可以提高很多了。任何的规范都是在特定情况下的某种妥协，脱离了这个环境，就不一定成立了。
 
