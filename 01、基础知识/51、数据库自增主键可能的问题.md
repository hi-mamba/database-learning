

# 数据库自增主键可能的问题

## 表锁

InnoDB自增值是通过其本身的自增长计数器来获取值，该实现方式是通过表锁机制来完成的（AUTO-INC LOCKING）。
锁不是在每次事务完成后释放，而是在完成对自增长值插入的SQL语句后释放，要等待其释放才能进行后续操作。
比如说当表里有一个auto_increment字段的时候，innoDB会在内存里保存一个计数器用来记录auto_increment的值，
当插入一个新行数据时，就会用一个表锁来锁住这个计数器，直到插入结束。
如果大量的并发插入，表锁会引起SQL堵塞。

## 自增长不连续