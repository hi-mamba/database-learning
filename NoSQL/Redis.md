# hello Word

## Redis有哪些数据结构？

字符串String、字典Hash、列表List、集合Set、有序集合SortedSet。

如果你是Redis中高级用户，还需要加上下面几种数据结构HyperLogLog、Geo、Pub/Sub。

如果你说还玩过Redis Module，像BloomFilter，RedisSearch，Redis-ML，面试官得眼睛就开始发亮了。

## Redis的内存用完了会发生什么？

随着现代操作系统的malloc()，返回NULL是不常见的，通常服务器会启动swap交换，
这样Redis的性能会随之降低，您也可能会发现某些不妥。

INFO命令可以查看Redis的使用量，因此您可以编写一个监视Redis服务器状态的临界监控脚本以检查服务器的状态。
或者可以在配置文件中使用“maxmemory”配置Redis可以使用的最大内存，
如果达到设置的上限，Redis的写命令会返回错误信息（但是读命令还可以正常返回。） 
或者你可以将Redis当缓存来使用配置淘汰机制，当Redis达到内存上限时会冲刷掉旧的内容。

## 使用过Redis分布式锁么，它是什么回事？

先拿setnx来争抢锁，抢到之后，再用expire给锁加一个过期时间防止锁忘记了释放。

### 这时候对方会告诉你说你回答得不错，然后接着问如果在setnx之后执行expire之前进程意外crash或者要重启维护了，那会怎么样？

这时候你要给予惊讶的反馈：唉，是喔，这个锁就永远得不到释放了。紧接着你需要抓一抓自己得脑袋，故作思考片刻，
好像接下来的结果是你主动思考出来的，然后回答：
我记得set指令有非常复杂的参数，这个应该是可以同时把setnx和expire合成一条指令来用的！
对方这时会显露笑容，心里开始默念：摁，这小子还不错。

## 假如Redis里面有1亿个key，其中有10w个key是以某个固定的已知的前缀开头的，如果将它们全部找出来？

使用keys指令可以扫出指定模式的key列表。

### 对方接着追问：如果这个redis正在给线上的业务提供服务，那使用keys指令会有什么问题？

这个时候你要回答redis关键的一个特性：redis的单线程的。keys指令会导致线程阻塞一段时间，线上服务会停顿，
直到指令执行完毕，服务才能恢复。这个时候可以使用scan指令，scan指令可以无阻塞的提取出指定模式的key列表，
但是会有一定的重复概率，在客户端做一次去重就可以了，但是整体所花费的时间会比直接用keys指令长。

## 使用过Redis做异步队列么，你是怎么用的？

一般使用list结构作为队列，rpush生产消息，lpop消费消息。当lpop没有消息的时候，要适当sleep一会再重试。

如果对方追问可不可以不用sleep呢？list还有个指令叫blpop，在没有消息的时候，它会阻塞住直到消息到来。 

如果对方追问能不能生产一次消费多次呢？使用pub/sub主题订阅者模式，可以实现1:N的消息队列。

如果对方追问pub/sub有什么缺点？在消费者下线的情况下，生产的消息会丢失，得使用专业的消息队列如rabbitmq等。

### 如果对方追问redis如何实现延时队列？
我估计现在你很想把面试官一棒打死如果你手上有一根棒球棍的话，
怎么问的这么详细。但是你很克制，然后神态自若的回答道：使用sortedset，拿时间戳作为score，
消息内容作为key调用zadd来生产消息，消费者用zrangebyscore指令获取N秒之前的数据轮询进行处理。

到这里，面试官暗地里已经对你竖起了大拇指。但是他不知道的是此刻你却竖起了中指，在椅子背后。

## 如果有大量的key需要设置同一时间过期，一般需要注意什么？

如果大量的key过期时间设置的过于集中，到过期的那个时间点，redis可能会出现短暂的卡顿现象。
一般需要在时间上加一个随机值，使得过期时间分散一些。

## Redis如何做持久化的？

bgsave做镜像全量持久化，aof做增量持久化。因为bgsave会耗费较长时间，不够实时，
在停机的时候会导致大量丢失数据，所以需要aof来配合使用。在redis实例重启时，
会使用bgsave持久化文件重新构建内存，再使用aof重放近期的操作指令来实现完整恢复重启之前的状态。

## 对方追问那如果突然机器掉电会怎样？
取决于aof日志sync属性的配置，如果不要求性能，
在每条写指令时都sync一下磁盘，就不会丢失数据。但是在高性能的要求下每次都sync是不现实的，
一般都使用定时sync，比如1s1次，这个时候最多就会丢失1s的数据。

## 对方追问bgsave的原理是什么？

你给出两个词汇就可以了，fork和cow。fork是指redis通过创建子进程来进行bgsave操作，
cow指的是copy on write，子进程创建后，父子进程共享数据段，父进程继续提供读写服务，
写脏的页面数据会逐渐和子进程分离开来。

##Pipeline有什么好处，为什么要用pipeline？

可以将多次IO往返的时间缩减为一次，前提是pipeline执行的指令之间没有因果相关性。
使用redis-benchmark进行压测的时候可以发现影响redis的QPS峰值的一个重要因素是pipeline批次指令的数目。

## Redis的同步机制了解么？

Redis可以使用主从同步，从从同步。第一次同步时，主节点做一次bgsave，
并同时将后续修改操作记录到内存buffer，待完成后将rdb文件全量同步到复制节点，
复制节点接受完成后将rdb镜像加载到内存。加载完成后，
再通知主节点将期间修改的操作记录同步到复制节点进行重放就完成了同步过程。

## 是否使用过Redis集群，集群的原理是什么？ 

Redis Sentinal着眼于高可用，在master宕机时会自动将slave提升为master，继续提供服务。

Redis Cluster着眼于扩展性，在单个redis内存不足时，使用Cluster进行分片存储。

## 如何保证 Redis中数据都是热点数据
相关知识：redis内存数据集大小上升到一定大小的时候，就会施行数据淘汰策略。
redis提供6种数据淘汰策略：
1、voltile-lru：从已设置过期时间的数据集（service.db[i].expires）中挑选最近最少使用的数据淘汰。
2、volatile-ttl：从已设置过期时间的数据集（service.db[i].expires）中挑选将要过期 数据淘汰。
3、volatile-random：从已设置过期时间的数据集（service.db[i].expires）中任意选择数据淘汰。
4、allkeys-lru：从数据集（service.db[i].dict）中挑选最少使用的数据淘汰。
5、allkeys-random：从数据集（service.db[i].dict）中任意选择数据淘汰。
6、no-enviction（驱逐）：禁止驱逐数据

 
 
## 1、什么是Redis？

## 2、Redis相比memcached有哪些优势？

## 3、Redis支持哪几种数据类型？

## 4、Redis主要消耗什么物理资源？

## 5、Redis的全称是什么？

## 6、Redis有哪几种数据淘汰策略？

## 7、Redis官方为什么不提供Windows版本？

## 8、一个字符串类型的值能存储最大容量是多少？

## 9、为什么Redis需要把所有数据放到内存中？

## 10、Redis集群方案应该怎么做？都有哪些方案？

## 11、Redis集群方案什么情况下会导致整个集群不可用？

## 12、MySQL里有2000w数据，redis中只存20w的数据，如何保证redis中的数据都是热点数据？

## 13、Redis有哪些适合的场景？

## 14、Redis支持的Java客户端都有哪些？官方推荐用哪个？

## 15、Redis和Redisson有什么关系？

## 16、Jedis与Redisson对比有什么优缺点？

## 17、Redis如何设置密码及验证密码？

## 18、说说Redis哈希槽的概念？

## 19、Redis集群的主从复制模型是怎样的？

## 20、Redis集群会有写操作丢失吗？为什么？

## 21、Redis集群之间是如何复制的？

## 22、Redis集群最大节点个数是多少？

## 23、Redis集群如何选择数据库？

## 24、怎么测试Redis的连通性？

## 25、Redis中的管道有什么用？

## 26、怎么理解Redis事务？

## 27、Redis事务相关的命令有哪几个？

28、Redis key的过期时间和永久有效分别怎么设置？

29、Redis如何做内存优化？

30、Redis回收进程如何工作的？

31、Redis回收使用的是什么算法？

32、Redis如何做大量数据插入？

33、为什么要做Redis分区？

34、你知道有哪些Redis分区实现方案？

35、Redis分区有什么缺点？

36、Redis持久化数据和缓存怎么做扩容？

37、分布式Redis是前期做还是后期规模上来了再做好？为什么？

38、Twemproxy是什么？

39、支持一致性哈希的客户端有哪些？

40、Redis与其他key-value存储有什么不同？

41、Redis的内存占用情况怎么样？

42、都有哪些办法可以降低Redis的内存使用情况呢？

43、查看Redis使用情况及状态信息用什么命令？

44、Redis的内存用完了会发生什么？

45、Redis是单线程的，如何提高多核CPU的利用率？

46、一个Redis实例最多能存放多少的keys？List、Set、Sorted Set他们最多能存放多少元素？

47、Redis常见性能问题和解决方案？

48、Redis提供了哪几种持久化方式？

49、如何选择合适的持久化方式？

50、修改配置不重启Redis会实时生效吗？
